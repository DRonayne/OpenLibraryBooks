# Project-wide Gradle settings.
# IDE (e.g. Android Studio) users:
# Gradle settings configured through the IDE *will override*
# any settings specified in this file.
# For more details on how to configure your build environment visit
# http://www.gradle.org/docs/current/userguide/build_environment.html

# ============================================================
# JVM Memory Configuration (optimised for Mac M3, 8 cores, 16GB RAM)
# ============================================================
# Allocate 6GB heap to Gradle, leaving ~10GB for Android Studio and other apps
# -Xms1024m: Start with 1GB heap
# -Xmx6144m: Max heap of 6GB
# -XX:MaxMetaspaceSize=1024m: Limit metaspace for class metadata
# -XX:+HeapDumpOnOutOfMemoryError: Create dump file if OOM occurs
# -XX:+UseParallelGC: Use parallel garbage collector for better throughput
org.gradle.jvmargs=-Xmx6144m -Xms1024m -XX:MaxMetaspaceSize=1024m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8 -XX:+UseParallelGC

# ============================================================
# Gradle Build Performance
# ============================================================
# Enable parallel builds to utilise all 8 cores efficiently
org.gradle.parallel=true

# Enable Gradle build cache for significantly faster incremental builds
org.gradle.caching=true

# Enable configuration cache (stable in Gradle 8.13+)
# Caches the result of configuration phase for faster subsequent builds
org.gradle.configuration-cache=true

# Limit max workers to 6 (leaving 2 cores for Android Studio and system)
org.gradle.workers.max=6

# Enable file system watching for faster change detection
# Gradle watches the file system for changes instead of scanning on each build
org.gradle.vfs.watch=true

# ============================================================
# Kotlin Compiler Daemon Configuration
# ============================================================
# Allocate 3GB to Kotlin daemon for compilation performance
kotlin.daemon.jvmargs=-Xmx3072m -Xms512m -XX:MaxMetaspaceSize=512m -XX:+UseParallelGC

# Enable incremental compilation for faster rebuilds
kotlin.incremental=true

# Enable precise Java tracking for better incremental compilation
kotlin.incremental.java=true

# ============================================================
# KSP (Kotlin Symbol Processing) Configuration
# ============================================================
# Enable incremental processing for KSP (used for Hilt, Room, etc.)
ksp.incremental=true

# Allow KSP to access non-public declarations for annotation processing
ksp.allow.internal.access=true

# ============================================================
# Android Build Optimisations
# ============================================================
# AndroidX package structure
android.useAndroidX=true

# Kotlin code style
kotlin.code.style=official

# Non-transitive R class for smaller R classes
android.nonTransitiveRClass=true

# Enable R8 full mode for better code shrinking and optimisation
android.enableR8.fullMode=true

# Use Jetifier to convert third-party libraries to AndroidX (disable if not needed)
# android.enableJetifier=true

# ============================================================
# Additional Performance Tweaks
# ============================================================
# Increase Gradle daemon idle timeout to 2 hours (avoids frequent restarts)
org.gradle.daemon.idletimeout=7200000